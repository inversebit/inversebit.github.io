<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[Inversebit]]></title><description><![CDATA[Inversebit]]></description><link>https://inversebit.org/</link><image><url>https://inversebit.org/favicon.png</url><title>Inversebit</title><link>https://inversebit.org/</link></image><generator>Ghost 4.32</generator><lastBuildDate>Wed, 16 Feb 2022 21:04:28 GMT</lastBuildDate><atom:link href="https://inversebit.org/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Integrating with ESPHome and Home assistant - Utsund revisited]]></title><description><![CDATA[Could my smart Utsund string light get better?]]></description><link>https://inversebit.org/utsund-revisited-integrating-with-esphome/</link><guid isPermaLink="false">61f673a7c5dba02d74c0d166</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Sat, 01 Jan 2022 00:01:00 GMT</pubDate><content:encoded><![CDATA[<p>If you&apos;ve read some of my older posts you&apos;ll know I <a href="https://inversebit.org/utsund-hack/">hacked an IKEA string light</a> in order to control it remotely with my smartphone (or any other device with a web browser). In the past few years home automation has bloomed rapidly and every appliance is now <em>smart</em>. And at the same time ope source alternatives to closed appliance control systems have appeared under my radar. One of the most well-known systems is <a href="https://www.home-assistant.io/">Home Assistant</a> also known as hassio.</p><h2 id="home-assistant">Home Assistant</h2><p>Home assistant is an smart appliance control system you can get in different forms, as a service you install on a linux box, docker container or a Raspberry Pi distribution. I got it this last way, just simply burn a microSD card following the <a href="https://www.home-assistant.io/installation/raspberrypi/">well-written instructions</a> and pop it in a spare Raspberry Pi.</p><p>After the system boots you can set up and use hassio through a web interface, the UI is generally pretty intuituive and easy to use. Hassio automatically detects some of the <em>smart devices</em> available on the network and offers to integrate them, letting you take control of your aplliances in a centralised way.</p><h2 id="esphome">ESPHome</h2><p>My utsund hack was a homebre solution, there was no way I could connect it to Hassio without reading its documentation, developing a firmware for the NodeMCU that controls it and setting everything up. Luckily for me a bunch of other people went this way before and created the <a href="https://esphome.io/">ESPHome</a> project.</p><p>ESPHome is a framework that let&apos;s you configure an ESP-based device (like the NodeMCU) through YAML files and generates a firmware image based on that configuration. The process is totally automated, the ESPHome CLI tool, downloads its toolchain and dependencies, converts the YAML code to whatever intermediate language it uses and finally compiles a firmware that it burns on the NodeMCU. It even offers you to do over-the-air updates!</p><p>The documentation is pretty extensive, but the organization lacking. Finding a way to reproduce what I already had donde for the Utsund string light was a bit cumbersome, but once I found the right documentation pages setting the YAML file up was a breeze.</p><pre><code>esphome:
  name: ikealights
  platform: ESP8266
  board: nodemcuv2

# Enable logging
logger:

# Enable Home Assistant API
api:
  password: &quot;super-secret-password&quot;

ota:
  password: &quot;even-more-secret-password&quot;

wifi:
  ssid: &quot;An IoT network&quot;
  password: &quot;thenetworkspassword&quot;

  manual_ip:
    static_ip: 192.168.50.100
    gateway: 192.168.50.1
    subnet: 255.255.255.0

switch:
  - platform: gpio
    pin: D2
    name: &quot;Ikea lights&quot;
</code></pre><p>I had to define the pin where I had connected the MOSFET which controls the power flow and set up the networking. And that&apos;s it! When the NodeMCU connected to my WiFi network hassio offered to add it to its system. From there on I had a switch on the hassio interface to turn on or off the lights from my PC or smartphone!</p><figure class="kg-card kg-image-card"><img src="https://inversebit.org/content/images/2022/01/onoff_utsund.gif" class="kg-image" alt loading="lazy" width="180" height="320"></figure><h2 id="automation-with-hassio">Automation with hassio</h2><p>Having integrated the utsund light string with hassio I couldn&apos;t leave it at that, hassio offers incredible functionality to make your life simpler. One of those features is automation. Automation routines let you link actions to triggers.</p><p>In my case I created an automation to turn on the light string when the sun sets, and turns them off at certain fixed time at night. I also tried out an automation to turn the strip on or off by reading an NFC tag, pretty useful if you want to avoid opening the app and pressing the button yourself.</p>]]></content:encoded></item><item><title><![CDATA[Smartifying a dumb vibrator]]></title><description><![CDATA[If a device doesn't meet your needs improve it!]]></description><link>https://inversebit.org/smartifying-a-dumb-vibrator/</link><guid isPermaLink="false">61f6737dc5dba02d74c0d162</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Sat, 01 Jan 2022 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p>Once again spending time in the bottomless pit that is the internet I found this great article from scanlime: <a href="https://scanlime.org/2012/11/hacking-my-vagina/">Hacking my vagina</a>. She explains from a very technical point of view how she reversed engineered and reimplemented a Lelo <em>sensemotion </em>remote to make it work her way.</p><p>I wanted to get my feet wet with a similar project, but instead of improving on an already connected vibrator I asked myself if I could transform a <em>dumb</em> vibrator to make it interactive and more versatile. There is no shortage of cheap devices on the market which one can only turn on or off. Could they also be improved?</p><h2 id="establishing-a-control-interface">Establishing a control interface</h2><p>The vibrator I had lying around at home was a cheap, dumb on/off bullet vibrator. You&apos;ll probably find those in any basic sex toy, and are also sold on their own. Some of the higher end devices offer wider control options, like different vibration intensities or patterns.</p><figure class="kg-card kg-image-card"><img src="https://inversebit.org/content/images/2022/01/00_vib_orig.jpg" class="kg-image" alt loading="lazy" width="504" height="378"></figure><p>As with many of my hacking projects I wanted to alter the device physically as less as possible. Given this condition, the obvious way to start with such a device would be to be able to control the power delivery. The chosen vibrator works with a AAA 1,5V battery which is stored inside it. The lid or cover which secures the battery has an embedded on/off switch.</p><p>The positive terminal can be found deep inside the device and the negative one is a piece of metal that runs up to the exit through a metal contact. Reaching the positive one seemed like quite of a challenge, but a 5,25 audio jack fit perfectly and made contact with its tip. The jack I found at home was an adapter, so I connected and old earbuds cable, peeled of the plastic and attached a dupont connector to it. The negative contact was easier to access, I simply lodged a cable between the audio adapter and the existing metal contact.</p><figure class="kg-card kg-image-card kg-width-wide"><img src="https://inversebit.org/content/images/2022/01/05_vib_collage.jpg" class="kg-image" alt loading="lazy" width="1512" height="378" srcset="https://inversebit.org/content/images/size/w600/2022/01/05_vib_collage.jpg 600w, https://inversebit.org/content/images/size/w1000/2022/01/05_vib_collage.jpg 1000w, https://inversebit.org/content/images/2022/01/05_vib_collage.jpg 1512w" sizes="(min-width: 1200px) 1200px"></figure><p>This way I achieved power delivery control. Form here on I connected the vibrator to an Arduino UNO through a MOSFET. The vibrator consumes a higher amperage than the Arduino is capable of delivering, therefore this transistor is needed. A relay could also be used, but would be pretty cumbersome to have, regarding the future minification of the control system.</p><figure class="kg-card kg-embed-card"><iframe width="200" height="150" src="https://www.youtube.com/embed/wGGWjiC9SWs?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><h2 id="ways-to-control-the-vib">Ways to control the vib</h2><p>Having established a way to control the vibrator, even with some leeway to set the intensity I thought out different ways to adjust its power.</p><h3 id="distance-through-ultrasound">Distance through ultrasound</h3><p>The first one was using an ultrasound sensor to measure distance, for example from a hand to the device, like scanlime wrote in her blogpost. This way the vibrator could be used like a <a href="https://en.wikipedia.org/wiki/Theremin">theremin</a>!</p><figure class="kg-card kg-embed-card"><iframe width="200" height="150" src="https://www.youtube.com/embed/7Otok7jKeNc?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>The experiment went quite well, but regarding a more realistic implementation, the sensor would need to be calibrated to detect movements in a smaller range near the sensor. It wouldn&apos;t be very practical to stretch your arm (or leg?) a meter into the air to make the device go faster. A non-linear mapping between distance and power would also be advisable.</p><h3 id="temperature">Temperature</h3><p>A vibrator belongs in a <em>hot </em>setting, does it not? Why not try to control its buzzing through temperature? I reckon that for this to work in a final product the thermometer would need to be somehow embedded in the vibrator and be able to quickly read temperatures in the range corresponding to the human skin.</p><p>Sadly, I didn&apos;t have such a thermometer. The only sensor available in my drawers was made to measure temperatures in the range from 0 to 400&#xBA;C (it was a 3D printer extruder thermistor). But it would suffice to set up a demo. The main obstacle I faced with this sensor was correctly mapping the temperature values to sensible power levels.</p><p>In the following video you can see the thermistor being drawn near a soldering iron at 300&#xBA;C and some ice.</p><figure class="kg-card kg-embed-card"><iframe width="200" height="150" src="https://www.youtube.com/embed/Rv0gilqp8os?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><h3 id="inclination">Inclination</h3><p>Going the Lelo sensemotion way, using inclination to set the vibration power would also be easily implemented. Using a <a href="https://learn.adafruit.com/mpu6050-6-dof-accelerometer-and-gyro/arduino">GY-521 or MPU6050</a> accelerometer/gyroscope one could measure the angle of the vibrator and make it buzz accordingly.</p><p>Although this doesn&apos;t sound like a very practical way to control it if the sensor is embedded in the device. Having the accelerometer in a separated in its own device making it work as a remote control, would be more useful.</p><p>One could also detect sudden or heavy movements with such sensor. Or maybe even detect a movement pattern with some clever post-processing on the raw data. This could be applied to gamify the vibrator use and reward the user when achieving a series of movements shown in an app, for example.</p><h3 id="music">Music</h3><p>Last but not least, I wanted to achieve buzzing control through music, but it ended up being more difficult than I anticipated.</p><p>I tried to reuse the ultrasound sensor for this use case, but as expected, it didn&apos;t really pick up the frequencies used by music. I then got a KY-038 sound detection sensor, but it also didn&apos;t work for music. Even though it could see it faintly detected the sound of music, it couldn&apos;t really be separated from the background noise baseline.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/image-2.png" class="kg-image" alt loading="lazy" width="800" height="338" srcset="https://inversebit.org/content/images/size/w600/2022/01/image-2.png 600w, https://inversebit.org/content/images/2022/01/image-2.png 800w" sizes="(min-width: 720px) 720px"><figcaption>Music cannot be clearly told apart from background noise</figcaption></figure><p>In the previous image I plotted the raw values the KY-038 sensor picked up during a few seconds. In the middle portion of the graphic you can see some seconds in which I played some music. In the image it may be pretty clear when it happened, but the differential between the values is too small to build a system that detects music reliably. And it even isn&apos;t able to pick up the music&apos;s rhythm.</p><p>After a bit of research I saw some people connected an audio jack directly to the microcontrollers analog input, which seemed like a pretty good idea, but I imagine that having cables around when using a vibrator isn&apos;t exactly exciting or practical. On top of that, modern smartphones are abandoning the headphone jack...</p><h2 id="app-control">App control</h2><p>I want to devote a whole section to the final way of controlling the vibrator. Nowadays smartphones are ubiquitous and most of the sex toy companies have jumped into the app bandwagon. Almost all of them have at least one smart or interactive device which can be used with a smartphone app.</p><p>Such an app could be used to enjoy solo play (for example synchronizing the device to music, like in the previous section), to maintain intimate contact in long distance relationships or enable discreet public play.</p><p>In some of the previous cases, internet connection is a must, in others not really, but the manufacturers force it onto their consumers. I&apos;m personally very privy to personal data and hate sharing any info which is not necessary. I therefore think that projects like <a href="https://buttplug.io/">Buttplug.io</a> are great initiatives to take control back and create our own experiencies in the field of sex toys.</p><p>But, coming back to the <em>smartifying a dumb vibrator project</em>, integrating my device with buttplug.io and building a client based on that library would be too much work.</p><p>Therefore I decided to build a webapp which would be hosted in the microcontroller which controlled the vibrator directly. I switched the Arduino UNO for a Wemos Mini D1 based on the ESP8266 and started writing some code based on my previous <a href="https://inversebit.org/cyperspikes/">Cyberspikes</a> project which used a similar control interface.</p><p>I designed four vibration patterns, rising intensity, sinking, sinusoidal wave and a random surprise pattern. I also added a way to control the maximum vibration power in order to avoid an uncomfortable situation.</p><p>I wanted to represent all of these patterns using mathematical functions instead of lookup tables, in the first place to avoid using more memory than needed (pretty constrained in a microcontroller) and to be able to generate a wave with the highest resolution possible.</p><p>One programmed, I tested the app by plotting the output voltage values, instead of connecting it to the vibrator directly. In the following video you may see the test:</p><figure class="kg-card kg-embed-card"><iframe width="200" height="113" src="https://www.youtube.com/embed/1u7utgxNOTo?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>After ironing out a few bugs and seeing everything was in order I assembled the prototype and tried it out with a spoon and come sugar. I really didn&apos;t know how to convey the vibrations in a <em>safe for work </em>video without relying entirely on sound:</p><figure class="kg-card kg-embed-card"><iframe width="200" height="113" src="https://www.youtube.com/embed/DeLQYaz8gxc?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><h2 id="future-work">Future work</h2><p>It&apos;s clear from the previous video that the vibrator cannot really be used with a few cables and a protoboard hanging around. Having finalized the software part the next one would be minification of the system.</p><p>The cool thing to do would be to design my own PCB board and create a self-contained small device, but I&apos;m not knowledgeable in that field yet. Therefore I would chose a smaller ESP8266 development board, squeeze all the electronics together and design a case I would later on 3D print.</p><p>Exploring the control ways I didn&apos;t get working would also be a nice way to improve this device. I&apos;m still interested about controlling the device with a thermometer, I haven&apos;t seen yet a sex toy using temperature this way.</p><p>Finally I still have to test what would happen if I exceed the 1,5 volts my vibrator is designed for, I think it could easily take at least 3V. It&apos;s just a DC motor and the vibrations could be much more powerful (= more fun?). But on the other side I still want to respect the device&apos;s limits, I wouldn&apos;t like to use an unsafe device.</p>]]></content:encoded></item><item><title><![CDATA[My Katana 60 mechanical keyboard]]></title><description><![CDATA[An account of my own keeb build]]></description><link>https://inversebit.org/my-katana-60-mechanical-keyboard/</link><guid isPermaLink="false">61e40b195b670c24a77273f2</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Fri, 01 Jan 2021 00:00:00 GMT</pubDate><content:encoded><![CDATA[<h2 id="the-search-for-a-mech-keyboard">The search for a mech keyboard</h2><p>Some time ago reading some hacking sites on the internet I saw an article talking about how awesome it is to type on a mechanical keyboard, since then I saw mech keyboards mentioned everywhere.</p><p>My first idea was to go the easy route and get a prebuild mechanical keyboard, I had no idea which switches to choose, what a customizable mech keyboard could do or the great world of custom-build mech keyboards.</p><h2 id="choosing-the-size-and-distribution-and-other-extras">Choosing the size and distribution and other extras</h2><p>I soon learned some aspects critical to a mechanical keyboard are its size and distribution.</p><h3 id="size">Size</h3><p>This one was quite a revelation! Not every keyboard has hundred-and-something keys and a Numpad (I love Logitech&apos;s K120), many mech keyboards I saw were on the smaller size.</p><p>Here&apos;s a almost-comprehensive outline form <a href="https://onsitego.com/blog/mechanical-keyboard-buying-guide-improve-productivity/">onsitego</a>:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/layouts.webp" class="kg-image" alt loading="lazy" width="700" height="1161" srcset="https://inversebit.org/content/images/size/w600/2022/01/layouts.webp 600w, https://inversebit.org/content/images/2022/01/layouts.webp 700w"><figcaption>Some existing keyboard layouts</figcaption></figure><p>The layout I preferred were the 75% or 65% ones. Losing the arrow keys was a no-go for me and he function keys are a nice extra for IDE shortcuts.</p><h3 id="key-distribution">Key distribution</h3><p>One could say there are only two distributions: ANSI and ISO. There are surely some others, but these two seem to dominate the market.</p><p>The ANSI distribution is the <em>American</em> one, and the ISO is used mostly in countries located in the EU. Each country having its own ISO variation (ISO-ES, ISO-FR, ISO-IT, ...)</p><p>Here&apos;s an image from <a href="https://commons.wikimedia.org/wiki/File:Physical_keyboard_layouts_comparison_ANSI_ISO.png">wikimedia</a> displaying both layouts:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/ansi_iso.png" class="kg-image" alt loading="lazy" width="763" height="600" srcset="https://inversebit.org/content/images/size/w600/2022/01/ansi_iso.png 600w, https://inversebit.org/content/images/2022/01/ansi_iso.png 763w" sizes="(min-width: 720px) 720px"><figcaption>ANSI and ISO keyboard distributions</figcaption></figure><p>Even though I&apos;m based on an EU country I wanted to get an ANSI keyboard, as I had heard from some programmers in my country that this simplified programming. That&apos;s because generally programming languages use symbols that are more easily accessible in an ANSI distribution. In most ISO distributions one has to use key combinations to get those symbols.</p><h3 id="additional-extras">Additional extras</h3><p>Mech keyboards normally have some extras only seen in <em>premium</em> keyboards (may they be mechanical or membrane ones), like key backlightning, RGB LEDs to show off, or some extra function keys. Some keyboards also allowed firmware modification using <a href="https://github.com/mtei/SemiErgo_Layout">QMK</a>.</p><p>I didn&apos;t <em>need</em> any of them, although key bakcklightning would have been a nice extra and custom firmware an incredible addition.</p><h2 id="finding-the-perfect-keyboard">Finding the perfect keyboard</h2><p>So, with a layout and distribution in mind I started looking for keyboard shops. Finding an online shop based on Europe (to avoid import taxes and tolls) was quite an adventure.</p><p>But in the end I located <a href="https://mykeyboard.eu/">https://mykeyboard.eu/</a> and <a href="https://candykeys.com/">https://candykeys.com/</a>. The thing is, mech keyboards seem to be such a wanted item that those shops hardly had (and have) on stock the keyboards I laid my eyes upon.</p><p>And which ones where those keyboards? Well, my favourite one was the <a href="https://en.varmilo.com/keyboardproscenium/subject_product_detailed?subjectid=29">Varmilo VA87M Panda</a>, a beautiful TKL keyboard.</p><p>The <a href="http://www.vortexgear.tw/vortex2_2.asp?kind=47&amp;kind2=225&amp;kind3=&amp;kind4=1044">Vortex RACE 3</a> was also a very strong contender, a compact (although slighlty boring-looking) 75% keeb.</p><p>But in the end I didn&apos;t get any of the ones I had lined up. What happened?</p><h3 id="keyboard-kits-and-diy">Keyboard kits and DIY</h3><p>Looking through candykeys catalogue for the Nth time I stumbled upon their DIY keyboard kits section. And OMG, that was exactly the way I like to roll! even though my maker-fu has a long way to go I dig building my own devices, and having a sort of path laid upon to help me build a fully custom mech keyboard was a great opportunity.</p><p>Building a custom keyboard consists on getting all components that make up a keyboard and assembling and soldering them together. Those components are: </p><ul><li>A <em>case</em> to put the keyboard into an protect it&apos;s most delicate components </li><li>A <em>PCB</em> where the key connections are printed and connect to the CPU (the keyboard&apos;s brains)</li><li>A metal <em>plate</em> to add robustness to the build</li><li>Many, many <em>switches</em>, the electro-mechanical components which convert the finger taps into electrical signals which get converted to symbols on the computer</li><li><em>Keycaps</em>, the plastic bits that are mounted on the switches and are tapped</li><li><em>Stabilizers</em> some metal wires and plastic bits that help anchoring the bigger keycaps so that they don&apos;t fly away when pressed</li></ul><p>I quickly got a crush on <a href="https://kbdfans.com/products/kbd67v2">KBDFANS&apos; KBD67 MKII</a> keyboard, but all of it&apos;s main components were not on stock and my patience was already pretty depleted.</p><p>And this way I found the <a href="https://geekhack.org/index.php?topic=100468.100">Katana 60 v2</a> keyboard.</p><h2 id="katana-60-v2">Katana 60 v2</h2><p>The Katana 60 v2 was a bit of an imposing keyboard which seemed difficult to get used to, given it&apos;s small size and unique key distribution. It&apos;s based on the <a href="https://github.com/mtei/SemiErgo_Layout">SemiErgo Layout</a>, based on a 60% size keyboard, reducing stress on the wrists.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/katana60.webp" class="kg-image" alt loading="lazy" width="700" height="525" srcset="https://inversebit.org/content/images/size/w600/2022/01/katana60.webp 600w, https://inversebit.org/content/images/2022/01/katana60.webp 700w"><figcaption>Katana 60 keyboard</figcaption></figure><p>RominRonin was the brave one designing a PCB to translate the SemiErgo concept to the real world, resulting in this beautiful keyboard. Even though I slightly feared such a drastic change (from a 100% ISO keyboard to this), I loved the idea of having such a distinctive keyboard.</p><p>I ordered the PCB and plate through candykeys, switches (gateron browns) and stabilizes through mykeyboard.eu and the cheapest case and keycaps i found on Amazon.</p><h3 id="led-mod">LED mod</h3><p>While waiting for everything to arrive I fantasized with the idea of adding a RGB LED to the keyboard as a status indicator for caps lock and other functions. And I found <a href="https://old.reddit.com/r/MechanicalKeyboards/comments/9uibfq/katana60_led_mod/">this mini-guide</a> from a Reddit user.</p><p>But there was a problem, this user added the LED to the Katana 60 V1 board, and I had the V2 with some slight modifications. Thankfully the Katana 60 being an open hardware keyboard I downloaded the Eagle files from <a href="https://github.com/rominronin/Katana60">its repo</a> and found the PCB traces I could solder some wires to to get the LED working.</p><p>As soon as I received the PCB I added the LED:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/led.webp" class="kg-image" alt loading="lazy" width="2000" height="588" srcset="https://inversebit.org/content/images/size/w600/2022/01/led.webp 600w, https://inversebit.org/content/images/size/w1000/2022/01/led.webp 1000w, https://inversebit.org/content/images/size/w1600/2022/01/led.webp 1600w, https://inversebit.org/content/images/2022/01/led.webp 2000w" sizes="(min-width: 720px) 720px"><figcaption>Custom LED installation</figcaption></figure><p>I added a semi-translucent band aid on it to diffuse its light and make give it a smoother appearance.</p><h3 id="assembling-the-keyboard">Assembling the keyboard</h3><p>Once all pieces arrived home I started to assemble the keyboard. The Katana60 allows the keys on the lower row to be distributed in different ways: a single spacebar or two split spacebar ways. I decided to set a single spacebar, but the plate didn&apos;t work with this layout so I slightly filed some edges. Aluminium being an easy metal to work aided this modification.</p><p>The order of assembly is critical in a custom mech keyboard. First the stabilizers are added to the PCB. There are <a href="https://switchandclick.com/how-to-mod-your-stabilizers-band-aid-clip-and-lube/">some tricks</a> to reduce their noise which can only be applied at this stage!</p><p>After the stabilizers are set, the plate with some switches to align it are connected to the PCB. With the plate on its place one places the rest of the switches, they are anchored mechanically to the PCB by way of simple pressure.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/switches-1.webp" class="kg-image" alt loading="lazy" width="1214" height="500" srcset="https://inversebit.org/content/images/size/w600/2022/01/switches-1.webp 600w, https://inversebit.org/content/images/size/w1000/2022/01/switches-1.webp 1000w, https://inversebit.org/content/images/2022/01/switches-1.webp 1214w" sizes="(min-width: 720px) 720px"><figcaption>Switch assembly</figcaption></figure><p>Then the switches are soldered to the backside of the PCB to form an electrical connection between them. Afterwards the whole assembly is placed on the case and screwed together. Finally I placed the keycaps.</p><p>But... whoops, due to the katana having quite an uncommon distribution and my decision to use a 2 unit backspace, when the board wasn&apos;t designed for it meaned I didn&apos;t have the keycaps for some of my keys.</p><p>I found this magnificent openscad project by rsheldiii <a href="https://www.thingiverse.com/thing:2783650">KeyV2</a>. It&apos;s a parametric key generator! I specified the sizes of the keys I needed in the program and rendered a model which I printed in 3D. And done, I got the keys I needed to complete my keyboard.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/openscad.webp" class="kg-image" alt loading="lazy" width="1559" height="700" srcset="https://inversebit.org/content/images/size/w600/2022/01/openscad.webp 600w, https://inversebit.org/content/images/size/w1000/2022/01/openscad.webp 1000w, https://inversebit.org/content/images/2022/01/openscad.webp 1559w" sizes="(min-width: 720px) 720px"><figcaption>A screengrab of Openscad, showing of the KeyV2 key definition</figcaption></figure><h3 id="the-firmware">The firmware</h3><p>But wait! We&apos;re not done yet. The keyboard on it&apos;s own is a dumb device without function. It needs a firmware in order to communicate with a PC and relay the keys that are pressed.</p><p>The Katana 60 can be flashed with the <a href="https://docs.qmk.fm/#/">QMK firmware</a>. It&apos;s a super-configurable sort of operating system for keyboards. I designed my layout on an <a href="https://config.qmk.fm/#/rominronin/katana60/rev2/LAYOUT_1_a">online editor</a>, exported it to my PC, added some modifications to make the LED work and compiled it.</p><p>After flashing the keyboard with it I had my own Katana 60 V2!</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/finished.webp" class="kg-image" alt loading="lazy" width="1000" height="466" srcset="https://inversebit.org/content/images/size/w600/2022/01/finished.webp 600w, https://inversebit.org/content/images/2022/01/finished.webp 1000w" sizes="(min-width: 720px) 720px"><figcaption>My own finished Katana 60 v2 keyboard</figcaption></figure><h2 id="some-final-thoughts">Some final thoughts</h2><p>After a year of using the Katana 60 I&apos;m still delighted by it. I love the feeling of mechanical switches and the keyboard&apos;s layout, although I&apos;m not using it correctly.</p><p>I don&apos;t think I&apos;m missing out on having more keys, the Katana&apos;s distribution and my custom take on it are more than enough to cover all my use cases.</p><p>Additionally, having a small keyboard allowed me to place the mouse further to the centre of my desk, reducing the travel distance from keyboard to mouse.</p><p>Thanks Rominronin for such an incredible design!</p>]]></content:encoded></item><item><title><![CDATA[Cyperspikes]]></title><description><![CDATA[My own take on Adafruit's Cyberpunk spikes]]></description><link>https://inversebit.org/cyperspikes/</link><guid isPermaLink="false">61e451a15b670c24a7727437</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Sat, 01 Aug 2020 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p>Browsing the magnificent Adafruit tutorials I came across the <a href="https://learn.adafruit.com/cyberpunk-spikes">Cyberpunk spikes</a> and immediately though of a good friend of mine who was in the middle of a weeks-long cyberpunk inspired role-playing game.</p><p>Being always open for a challenge I agreed to build a replica for them, but improving upon adafruit&apos;s version. I wanted to add wireless capabilities to change colour and pattern, easy to use snap-connectors for the spike strips, the possibility to add one or two strips and a way to use a universal USB power supply (probably a power bank).</p><h2 id="3d-printing-the-spikes">3D Printing the spikes</h2><p>I got some <a href="https://www.smartmaterials3d.com/flex-filamento">Smartmaterials Flex</a> filament to print the spikes which worked pretty well. The only issue at this stage was fitting the spikes inside my 3D printer bed, which isn&apos;t really large. So I split the model in two smaller strips and the fused them together using a soldering iron. The result was better than expected.</p><p>Afterwards I simply glued them on top of a waterproof neopixel LED strip and put some magnets on the under-side so that they stay in place when worn.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/spikes_fused.jpg" class="kg-image" alt loading="lazy" width="1674" height="802" srcset="https://inversebit.org/content/images/size/w600/2022/01/spikes_fused.jpg 600w, https://inversebit.org/content/images/size/w1000/2022/01/spikes_fused.jpg 1000w, https://inversebit.org/content/images/size/w1600/2022/01/spikes_fused.jpg 1600w, https://inversebit.org/content/images/2022/01/spikes_fused.jpg 1674w" sizes="(min-width: 720px) 720px"><figcaption>The 3D printed cyperspikes glued on top of the LED strips</figcaption></figure><p>I also 3D printed a simple PLA case to house the microcontroller which would drive the light strips. I added an abstract design to the housing to make it look more <em>cyber.</em></p><h2 id="electronics">Electronics</h2><p>I decided to go for the smallest ESP8266 based development board in order to reduce the controllers footprint and be able to add wireless remote control capabilities to the spikes.</p><p>Following this criteria I chose a Wemos D1 mini board. I would only need to use two digital pins for sending the neopixel control commands, and that board even had a 5V port which was really nice to get the power from for the LED strips. Using 3,3V (the only voltage available in many ESP8266 dev boards) would have impacted in the LED&apos;s brightness.</p><p>Initially I used Adafruit&apos;s neopixel library to control the strips, but I found some difficulties which limited what I could do with the cyber-spikes. Looking around I stumbled upon a great LED controller library named <a href="http://fastled.io/">FastLED</a> which is incredibly powerful. After studying some of their example programs I picked the patterns I liked most and whipped up a simple program to light up the stripes.</p><h2 id="snap-connectors">Snap connectors</h2><p>One of the other improvement I metioned are the snap connectors. I bought a pack of 3 wire male and female connectors and soldered them to the LED strips and the microcontroller which would control them.</p><p>The microcontroller would send the secondary light strip the same signal as the primary one, so connecting a single stripe on any of both connectors wouldn&apos;t really matter. This way the user could wear a single or a double spike strip.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/spikes_case.jpg" class="kg-image" alt loading="lazy" width="1304" height="978" srcset="https://inversebit.org/content/images/size/w600/2022/01/spikes_case.jpg 600w, https://inversebit.org/content/images/size/w1000/2022/01/spikes_case.jpg 1000w, https://inversebit.org/content/images/2022/01/spikes_case.jpg 1304w" sizes="(min-width: 720px) 720px"><figcaption>The case housing the microcontroller and its snap connectors</figcaption></figure><h2 id="remote-control">Remote control</h2><p>What fun are RGB LEDs you cannot light up as desired? The cyperspikes needed a remote control! But, having to carry an IR blaster with you everywhere isn&apos;t the most user-friendly way to do this.</p><p>Guess what&apos;s in (almost) everybody&apos;s pocket: A smartphone. The thing is, I didn&apos;t want to make a native app to control the lights, so I decided to make a web app and serve it from the ESP8266 directly.</p><p>When booted up the microcontroller sets up a WiFi access point. The user can then connect (temporarily) their phone to the microcontroller and access a webpage its serving, which contains a few buttons to configure the LEDs. Each button sends a POST message to the ESP8266 which changes the light pattern accordingly.</p><figure class="kg-card kg-embed-card"><iframe width="200" height="113" src="https://www.youtube.com/embed/2bTsu4fYTdA?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure>]]></content:encoded></item><item><title><![CDATA[Utsund hack]]></title><description><![CDATA[Adding remote control capabilities to IKEA's Utsund string light]]></description><link>https://inversebit.org/utsund-hack/</link><guid isPermaLink="false">61e409b95b670c24a77273ca</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Wed, 01 Apr 2020 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p>Looking through the Ikea catalog I came upon the <a href="https://www.ikea.com/us/en/p/utsund-led-string-light-with-12-lights-outdoor-battery-operated-black-00421133/">UTSUND string light</a> and though about customizing it with some painted cans I had at home. The thing is, I didn&apos;t have enough cans for each LED bulb, so I decided to set it up over my couch while I waited to collect the necessary materials to carry out my original idea.</p><p>The UTSUND string is battery powered. It stays on for a few ours and automatically powers off. Being a bit of a couch potato I thought of making some sort of remote control for the lights. On the one hand some sort of receiver would be needed on the lights side, and a remote on the other one. Trying to avoid reinventing the wheel and using what`s already available I thought of using my smartphone to control the lights.</p><p>To control the lights I needed a microcontroller and a relay, but with these lights being such an light-powered device a MOSFET would be enough. As wireless-capable microcontroller I chose a NodeMCU based on the ESP8266. The NodeMCU would be connected to my local home WiFi network.</p><p>I didn&apos;t want to set up any cloud servers for this task, as I wanted a simple solution and had no need to turn the lights on or off when outside my home. Taking this into account and trying to avoid developing a specific app for the smartphone I thought the NodeMCU could act as a server showing a simple webpage to act on the string light. This would also be a universal solution, I could use not only my smartphone but any device to switch the lights on or off without any setup.</p><p>So, taking all of this into account I set up a simple test with a single LED on a breadboard.</p><figure class="kg-card kg-embed-card kg-card-hascaption"><iframe width="200" height="113" src="https://www.youtube.com/embed/BgJbGBgVN2c?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><figcaption>Demo video displaying the first prototyping stages</figcaption></figure><p>Then I connected the same setup to the string light, using the NodeMCU to power the lights directly. The original power source is 3 AA batteries, that would be 4.5V aprox. The NodeMCU operates at 3.3V, but the USB port receives 5V. In order to take advantage of these 5V I soldered a wire to a component skipping the power circuit in the NodeMCU.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/utsund_0.jpg" class="kg-image" alt="Testing the connections on a breadboard" loading="lazy" width="1000" height="750" srcset="https://inversebit.org/content/images/size/w600/2022/01/utsund_0.jpg 600w, https://inversebit.org/content/images/2022/01/utsund_0.jpg 1000w" sizes="(min-width: 720px) 720px"><figcaption>Testing the connections on a breadboard</figcaption></figure><p>After checking that everything worked OK I made the final connections between the NodeMCU and string light and emptied the batteries case. I reused it to house the microcontroller, MOSFET and wires.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/utsund_1.jpg" class="kg-image" alt="Final connections" loading="lazy" width="1000" height="750" srcset="https://inversebit.org/content/images/size/w600/2022/01/utsund_1.jpg 600w, https://inversebit.org/content/images/2022/01/utsund_1.jpg 1000w" sizes="(min-width: 720px) 720px"><figcaption>Final connections</figcaption></figure><p>I reused the original Utsund battery case in order to hide the electronics within.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/utsund_2.jpg" class="kg-image" alt="Case where the electronics are housed" loading="lazy" width="1000" height="750" srcset="https://inversebit.org/content/images/size/w600/2022/01/utsund_2.jpg 600w, https://inversebit.org/content/images/2022/01/utsund_2.jpg 1000w" sizes="(min-width: 720px) 720px"><figcaption>Case where the electronics are housed</figcaption></figure>]]></content:encoded></item><item><title><![CDATA[Pcmon]]></title><description><![CDATA[Analog visualization for PC resources]]></description><link>https://inversebit.org/pcmon/</link><guid isPermaLink="false">61e337d1c6d1460f2de7833e</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Sat, 01 Sep 2018 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p><a href="https://github.com/Inversebit/kikimora">Repo Link</a></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/P8231039.JPG" class="kg-image" alt loading="lazy" width="450" height="338"><figcaption>Front view of the pcmon device</figcaption></figure><p>Lately I was using some resource-intensive programs at work and couldn&#x2019;t reserve screen space for the task manager, in order to keep tabs on the CPU and RAM use.</p><p>To solve this problem I decided to create an external device which could show those values I was interested in. But I also wanted to create something striking to have on my desk. I decided to use a pair of analog VU-meters to reach the desired goals.</p><h3 id="programming">PROGRAMMING</h3><p>The system is composed of a server and a client application.</p><h4 id="server">Server</h4><p>The server app is a .NET console app I quickly whipped out on Visual Studio. I didn&#x2019;t want to invest any time here.</p><p>The program reads the system resource values, adapts them to a 0-100 percent range and sends them to the client arduino app via serial communication.</p><h4 id="client-arduino">Client (Arduino)</h4><p>The client app is an Arduino program. It reads the values passed from the server via serial, does a little processing and shows them in the VU-meters.</p><p>As you&#x2019;ll see in the <em>Electronics</em> section the VU-meters aren&#x2019;t but a pair of modified voltage meters. In order to show any value on them the arduino just needs to generate a voltage in a given range. That&#x2019;s accomplished via PWM output.</p><p>There are also a pair of RGB LED strips. These change colour based on the load of the system. Up to 60% load the Arduino just uses a blue-ish tint. But when the values climb above that threshold the colour becomes warmer, ranging from yellow to red.</p><p>To do this colour progression I decided to use the HSV colourspace and alter the <em>hue</em> proportionally to the value shown in the VU-meter. This was an incredible simple way to implement this functionality.</p><h3 id="electronics">ELECTRONICS</h3><p>The base of this system is an Arduino UNO board. Only 3 of the PWM outputs are used to make everything work.</p><h4 id="vu-meters">VU-meters</h4><p>The VU-meters are a pair of voltage meters I bought on ebay. Their original range was 0-15V, I opened them up and changed the resistor they had inside to make them work on a 0-3.3V range, originally I was going to use a NodeMCU board as the brains.</p><p>I then scanned the voltmeter&#x2019;s panel and designed with GIMP a new one for CPU values and another one for RAM values. I printed them and stuck them over the original panel.</p><p>To show a value on the VU-meter the arduino just has to generate a specific voltage on the 0-3.3V range via one of the PWM ports.</p><h4 id="led-sticks">LED sticks</h4><p>I used a pair of LED sticks to give a sort of backlight to the VU-meters.</p><p>Originally I didn&#x2019;t want to create backlightning, just a way to warn me when the meters reached their max values. To achieve this I wanted to use a simple red LED, but I didn&#x2019;t have anywhere to put it and didn&#x2019;t have the tools to modify the VU-meters&#x2019; enclosure.</p><p>I then used the LED sticks to make the meters glow when their max values where reached, but wanted to create a cooler effect. All in all, RGB LEDs are capable of much more than just what I intended to use them for.</p><p>Due to some problems with Adaruit&#x2019;s neopixel library I found and ended up using the <a href="http://fastled.io/">fastled</a> library to drive the LED sticks. This library also allowed me to use the HSV colourspace and solve the color-progression problem easily.</p><h3 id="exterior">EXTERIOR</h3><p>In order to make the device self-contained I started to design a simple enclosure with CAD software, but soon it become clear that it would be pretty big. In order to avoid printing large pieces I only printed the front panel, which on its backside has supports for the heavy VU-meters.</p><p>The rest of the enclosure was made with a cardboard box and taped together.</p><h3 id="putting-it-together">PUTTING IT TOGETHER</h3><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/pcmon_demo.gif" class="kg-image" alt="Demo" loading="lazy" width="600" height="338"><figcaption>A small animation showing of pcmon&apos;s capabilities</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/P8231039-1.JPG" class="kg-image" alt="Image02" loading="lazy" width="922" height="692" srcset="https://inversebit.org/content/images/size/w600/2022/01/P8231039-1.JPG 600w, https://inversebit.org/content/images/2022/01/P8231039-1.JPG 922w" sizes="(min-width: 720px) 720px"><figcaption>Front view of the pcmon device</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/P8231053.JPG" class="kg-image" alt="Image04" loading="lazy" width="922" height="692" srcset="https://inversebit.org/content/images/size/w600/2022/01/P8231053.JPG 600w, https://inversebit.org/content/images/2022/01/P8231053.JPG 922w" sizes="(min-width: 720px) 720px"><figcaption>Pcmon device internals, displaying an arduino UNO, the backside of both voltmeters and two small Neopixel strips all wired up</figcaption></figure>]]></content:encoded></item><item><title><![CDATA[Imek]]></title><description><![CDATA[Building UIs form a sketch]]></description><link>https://inversebit.org/imek/</link><guid isPermaLink="false">61e33645c6d1460f2de78335</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Wed, 01 Nov 2017 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p>Inspired by this <a href="https://airbnb.design/sketching-interfaces/">blog post</a> from Airbnb I decided to try my luck building an Android app which would create a GUI form a sketch.</p><p>A designer will draw a quick sketch of the desired GUI, and then photograph it with the Imek app. Imek will then analyze the sketch, extracting the sketched GUI components and the way they are ordered. The app will then instantiated native OS components and create a GUI in the same order as in the sketch. The end result will be a mock GUI created the same way as in the sketch.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/00_imek_sketch.jpg" class="kg-image" alt="Imek sketch" loading="lazy" width="697" height="800" srcset="https://inversebit.org/content/images/size/w600/2022/01/00_imek_sketch.jpg 600w, https://inversebit.org/content/images/2022/01/00_imek_sketch.jpg 697w"><figcaption>A sketch of Imek&apos;s internal processing pipeline</figcaption></figure><p>This project will contain:</p><ul><li>Image processing &#x2013;&gt; To parse the sketch</li><li>Machine learning &#x2013;&gt; To interpret the parsed figures</li><li>Android programming &#x2013;&gt; To dynamically generate a GUI and present it to the user</li></ul><h2 id="part-2element-extraction">Part 2 - Element Extraction</h2><p>In the first iteration of the element extraction code I managed to read a squares array and create subimages with each individual square.</p><p>This is an example of the input image:<br></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/01_input.png" class="kg-image" alt="Input" loading="lazy" width="543" height="728"><figcaption>A sketch of multiple boxes with a cross inside, representing an image element</figcaption></figure><p>The image was manipulated using the following methods:</p><ol><li>Conversion to grayscale image</li><li>Gaussian blur applied, with a 51x51 kernel, in order to eliminate small imperfections on the image</li><li>An adaptive Gaussian thresholding is then run on the image in order to create a binary image containing the most prominent lines</li><li>Smoothing of the resulting lines from the previous step a. 4 iterations of dilation with a 7x7 kernel b. 2 steps of erosion with a 7x7 kernel c. A Median blur is applied in order to eliminate small pixel islands which may have appeared after the dilation step</li></ol><p>After the image is preprocessed opencv&#x2019;s <code>findCountours</code> function is called with the <code>cv2.RETR_EXTERNAL</code> and <code>cv2.CHAIN_APPROX_SIMPLE</code> parameters. This will find the external contours of the squares.</p><p>The resulting contours are then filtered, in order to eliminate the smallest ones, which may be small pixel islands which are not a square. This step uses a hardcoded minimal area, but it should use a relative area measurement based on the image size.</p><p>With the final contours on our hands, the code proceeds to created bounding rectangles on the contours, which will contain the squares we were looking for. The following image shows the input image through some parts of the process:<br></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/02_processing.png" class="kg-image" alt="Processing" loading="lazy" width="1608" height="580" srcset="https://inversebit.org/content/images/size/w600/2022/01/02_processing.png 600w, https://inversebit.org/content/images/size/w1000/2022/01/02_processing.png 1000w, https://inversebit.org/content/images/size/w1600/2022/01/02_processing.png 1600w, https://inversebit.org/content/images/2022/01/02_processing.png 1608w" sizes="(min-width: 720px) 720px"><figcaption>Multiple screensgrabs displaying how Imek processes images to extract individual elements</figcaption></figure><p>With the bounding rectangles on our hands the original image is reloaded and reprocessed again using similar steps to the ones previously described. The resulting image is used for the extraction of subimages based on the defined bounding rectangles. This process results in a list of subimages containing only the squares:<br></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/03_res_squares.png" class="kg-image" alt="result" loading="lazy" width="554" height="340"><figcaption>Multiple image files as the initial sketched boxes, identified and split in individual entitites</figcaption></figure><h2 id="part-3element-extraction-continued">Part 3 - Element Extraction (Continued)</h2><p>The third iteration of the image extraction script is a refinement on the first one. The new script lets the user play with the parameters used in the algorithms freely and save the results when the expected result is met.</p><p>This version does also take into account the order in which the elements are ordered vertically.</p><p>I used the script to extract 3 types of elements to train the future classifier:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/04_elems.png" class="kg-image" alt="elements" loading="lazy" width="586" height="176"><figcaption>Other elements identified by Imek</figcaption></figure><h2 id="part-4classifier">Part 4 - Classifier</h2><p>To know what Imek is about visit the <a href="https://inversebit.github.io/imek/2017/11/21/imek-intro.html">introduction blog post</a>.</p><p>The next step for the Imek project is to be able to classify the individual elements detected on an image. Knowing which element is represented with each image will make it possible to build the UI in the next milestone of this project.</p><p>I decided to use <a href="https://www.tensorflow.org/">tensorflow</a> as the machine learning framework to use. It struck me how difficult it seemed to simply get going and create a simple classifier. Well, after some wasted hours I stumbled upon <a href="https://hackernoon.com/creating-insanely-fast-image-classifiers-with-mobilenet-in-tensorflow-f030ce0a2991">this blog post</a> in which the author used tensorflow&#x2019;s example scripts to train a model and classify an image. It seems that using the examples provided by the tensorflow authors is a much better place to start than documentation.</p><p>With the <code>retrain.py</code> script I was able to quickly retrain the <em>mobilenet_1.0_224</em> network. With <code>label_image.py</code> I tested it quickly, obtaining satisfactory results.</p><p>I then continued by taking tensorflow&#x2019;s Android example and extracting the ImageCalssifier. I then built a simple prototype app which did the same classification I did manually on Android.</p><h2 id="part-5app-demo">Part 5 - App demo</h2><p>To know what Imek is about visit the <a href="https://inversebit.github.io/imek/2017/11/21/imek-intro.html">introduction blog post</a>.</p><p>Here&#x2019;s a demo of the prototype app I&#x2019;ve built over the last days. It takes a picture of a sketched interface, applies the image processing algorithms described in the previous blog posts and labels the extracted subimages with the retrained <em>mobilenet</em> neural network.</p><p>Having classified every UI fragment the app rebuilds it with native android components. For now it only builds interfaces with <code>ImageView</code>s, <code>TextView</code>s and <code>RadioGroup</code>s.</p><figure class="kg-card kg-embed-card"><iframe width="200" height="113" src="https://www.youtube.com/embed/KbMCT6JQw48?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure><p>The code is available in the <a href="https://github.com/Inversebit/imek/tree/master">Imek repo</a>.</p>]]></content:encoded></item><item><title><![CDATA[Kikimora]]></title><description><![CDATA[An ESP8266-based systems monitoring device]]></description><link>https://inversebit.org/kikimora/</link><guid isPermaLink="false">61e31e39c6d1460f2de7830e</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Wed, 01 Feb 2017 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p><a href="https://github.com/Inversebit/kikimora">Repo Link</a></p><p>Kikimora was born form an idea given to me by colleague at work. The idea was to create a simple device, which with the aid of two LEDs would indicate if a computer system is up or down. The device could be set on top of any computer screen in order to make it easy to check out.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/kikimora_small.png" class="kg-image" alt="The kikimora device" loading="lazy" width="274" height="200"><figcaption>The kikimora device</figcaption></figure><p>I specified further what I would try to accomplish and thought of the following: The device would be configured to ping or somehow GET a webpage every X seconds. If the page responded with a 200 HTTP code, let&#x2019;s light the green LED, any other message: red LED.</p><p>After that I added some requirements to the device: to make it self-contained, as simple as possible to use, and small (in that order). So, I started the hunt for an arduino-like platform with embedded WiFi capabilities, and landed on the <a href="https://en.wikipedia.org/wiki/ESP8266">ESP8266</a> module family. I bought an ESP8266-01 and ESP8266-12E, because they are dirty cheap. I ended up using the 01, the reason is simple, I liked the restrictions imposed upon me by using such a &#x201C;simple&#x201D; device. It only offered me a WiFi link and 2 GPIO ports (though I&#x2019;m sure someone has already invented some kind of hack to use the RX/TX ports for GPIO).</p><h3 id="programming">PROGRAMMING</h3><p>After a long afternoon programming the ESP8266 I managed to cram a program which did the following:</p><ul><li>Setup a Wifi connection to a hardcoded network</li><li>Setup an internal timer (based on the OSs functionality, and not some cheesy software hack)</li><li>Host a configuration page to setup the page to monitor</li><li>Write some code to light a LED or the other based on the target website&#x2019;s status</li></ul><p>I took into account the hardware limitations and avoided to work too long in the device&#x2019;s main (and only?) thread.</p><p>The code is available in the project&#x2019;s repo, linked at the start of this article.</p><h3 id="electronics">ELECTRONICS</h3><p>The electronics were pretty basic, in the end it&#x2019;s just a microcontroller and two LEDs. In order to pursue the &#x201C;simplicity&#x201D; aspect of the project I wanted to supply the juice via an USB port, like most handheld devices around us. Two problems arise: 1. A micro-usb port is probably fragile + difficult to solder in a perfboard. 2. USB provides 5V&#x2026; and the ESP8266 needs 3.3V.</p><p>The first one I solved using and old-school USB-A female port. To solve the second one I wanted to get away with a voltage divider, but due to the laws of electronics it wound up to be a difficult task, so I summoned all my patience, order a bunch of voltage regulators on ebay and put the project on hold for a week. When they arrived everything worked perfectly.</p><p>The schematic for the circuit is as follows:<br></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/schema.png" class="kg-image" alt="Electrical diagram of kikimora" loading="lazy" width="865" height="404" srcset="https://inversebit.org/content/images/size/w600/2022/01/schema.png 600w, https://inversebit.org/content/images/2022/01/schema.png 865w" sizes="(min-width: 720px) 720px"><figcaption>Electrical diagram of kikimora</figcaption></figure><p>First, sorry for putting an ESP8266 which is the wrong module in the schematic, but I didn&#x2019;t find the 01&#x2026; Secondly, there is no much mystery to it. The resistor after the LEDs should avoid the build up of &#x201C;infinite&#x201D; current, and that&#x2019;s all.</p><p>The first prototypes I tried out in the proverbial protoboard. The <em>definitive</em> circuit was build on a perfboard. Pretty badly. I should get a better soldering iron and something to hold the board and components while I solder them. Sorry for the terrible craftsmanship you&#x2019;ll see in the photos.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/000.JPG" class="kg-image" alt="Kikimora internals #1" loading="lazy" width="1000" height="664" srcset="https://inversebit.org/content/images/size/w600/2022/01/000.JPG 600w, https://inversebit.org/content/images/2022/01/000.JPG 1000w" sizes="(min-width: 720px) 720px"><figcaption>Kikimora internals #1</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/001.JPG" class="kg-image" alt="Kikimora internals #2" loading="lazy" width="1000" height="593" srcset="https://inversebit.org/content/images/size/w600/2022/01/001.JPG 600w, https://inversebit.org/content/images/2022/01/001.JPG 1000w" sizes="(min-width: 720px) 720px"><figcaption>Kikimora internals #2</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/002.JPG" class="kg-image" alt="Kikimora internals backside" loading="lazy" width="1000" height="544" srcset="https://inversebit.org/content/images/size/w600/2022/01/002.JPG 600w, https://inversebit.org/content/images/2022/01/002.JPG 1000w" sizes="(min-width: 720px) 720px"><figcaption>Kikimora internals backside</figcaption></figure><p>There are two more things I would like to talk about: First the operating voltage. As you have probably notices there is a voltage regulator which reduces the USB&#x2019;s 5V to 3.3V for the ESP8266. The bad thing about this is that the LEDs will be slightly underpowered, emitting only a very faint light.</p><p>Secondly, the ESP8266 is mounted on some pins and not directly soldered to the perfboard. This is so in order to make it easier to reprogram the microchip in the future without much hassle. The downside: The high occupied by the whole ensemble, which is quite a lot for a device of this size.</p><h3 id="exterior">EXTERIOR</h3><p>The exterior is a simple parallelepiped or a rectangle with volume. I made it so that I could be easily opened in the middle and accommodate all the components (mainly regarding height).</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/005.JPG" class="kg-image" alt="Kikimora 3D printed case" loading="lazy" width="1000" height="650" srcset="https://inversebit.org/content/images/size/w600/2022/01/005.JPG 600w, https://inversebit.org/content/images/2022/01/005.JPG 1000w" sizes="(min-width: 720px) 720px"><figcaption>Kikimora 3D printed case</figcaption></figure><p>The bottom part of the case takes the board. The perfboard is mounted on two screws and the edge of the case, leaving a bit of space beneath for some cables and solder blobs. The top was build with the height constraints in mind. There are two holes for the LEDs to go through, and a notch for the upper half of the USB port.</p><p>I designed the case in <a href="https://www.freecadweb.org/">FreeCAD</a> (in a pretty unorthodox way, regarding good practices). The top half was a bit of trial and error thing, it was difficult to define the right height for the piece and LED hole diameter, taking into account my printer&#x2019;s tolerances and accuracy error.</p><p>I exported the models to STL meshes and converted them to gcode using <a href="https://ultimaker.com/en/products/cura-software">Cura 15</a>. Then I printed the case in my <em>Prusa i3</em>-model 3D-printer in PLA plastic.</p><h3 id="putting-it-together">PUTTING IT TOGETHER</h3><p>To finish it of I glued the LEDs to the perfboard with some silicone sealant and decided to bend the voltage regulator beneath the ESP8266 board in order to avoid it hitting the top of the case. As it doesn&#x2019;t heat up too much I think it won&#x2019;t cause a problem there.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/003.JPG" class="kg-image" alt="Kikimora internals, fully assembled" loading="lazy" width="1000" height="513" srcset="https://inversebit.org/content/images/size/w600/2022/01/003.JPG 600w, https://inversebit.org/content/images/2022/01/003.JPG 1000w" sizes="(min-width: 720px) 720px"><figcaption>Kikimora internals, fully assembled</figcaption></figure><p>You&apos;ve seen the complete build on the beginning of this article:</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/004.JPG" class="kg-image" alt="Outside view of the kikimora device, fully assembled" loading="lazy" width="1000" height="730" srcset="https://inversebit.org/content/images/size/w600/2022/01/004.JPG 600w, https://inversebit.org/content/images/2022/01/004.JPG 1000w" sizes="(min-width: 720px) 720px"><figcaption>Outside view of the kikimora device, fully assembled</figcaption></figure><p>The ESP8266&#x2019;s code, CAD and STL models are all open source. You can find a link to the <a href="https://github.com/Inversebit/kikimora">repo</a>.</p>]]></content:encoded></item><item><title><![CDATA[Bannik]]></title><description><![CDATA[A status monitoring semaphore]]></description><link>https://inversebit.org/bannik/</link><guid isPermaLink="false">61e31d8fc6d1460f2de782f2</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Thu, 01 Dec 2016 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p>Project bannik is created as a platform to receive and show real-time alerts regarding the status of any computer system. In my particular case the main objective is to use it as a device to show alerts regarding uptime in web pages and apps, REST services and other software systems some of my other programs depend upon.</p><p>Bannik will be formed by a hardware device and a software counterpart to control it. The hardware will be acquired keeping a low cost in mind and using what I have laying around. Regarding software, only open source systems will be used.</p><p>I visualize an unconventional &#x201C;semaphore&#x201D; regarding current standards. The idea is to use a single multicolor disc to show a status quickly (via colors) and a screen to get further information on an alert. Some sort of acoustic signal could be an improvement. The device could be mounted on a wall, or placed on a desk.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/00_bannik_sketch.png" class="kg-image" alt loading="lazy" width="711" height="325" srcset="https://inversebit.org/content/images/size/w600/2022/01/00_bannik_sketch.png 600w, https://inversebit.org/content/images/2022/01/00_bannik_sketch.png 711w"><figcaption>A sketch of the outside appearance of the bannik device</figcaption></figure><p>Regarding the screen I would like to use some sort of panel that is easy to read, I have my mind set on an e-paper one. Going back to the &#x201C;disc&#x201D;, something regarding RGB LEDs could be useful.</p><p>I&#x2019;ve already specified the innards of the bannik monitor:</p><ul><li>A RaspberryPi Model B (1st gen), it will run on Raspbian Jessie Lite</li><li>A TPlink TL-WN722N, to bless the RPi with WiFI connectivity</li><li>An Amazon kindle 4, as readable &#x201C;more info&#x201D; screen</li><li>Two RGB LED Rings, 24 and 12 LEDs respectively</li><li>To power all of this I got a 25W (5V, 5A) power supply</li></ul><p>Let&#x2019;s talk about the list: First, the RPi. I had it laying around. I think current RPis are a bit overpriced, but very capable devices. I considered an Arduino, which would be a better candidate to interface with the hardware, but, it&#x2019;s easier to make an RPi host a REST API + other future improvement ideas, than an Arduino. Regarding the WiFi dongle, I&#x2019;ve got nothing to say. It was cheap on amazon, some people said it worked, others that not. Well, when I got it I plugged it in the RPi and worked flawlessly. No driver installation, no kernel module recompilation, no nothing.</p><p>The kindle is my answer to an easily readable screen to get further information on bannik&#x2019;s alerts. But, multiple problems arise: How am I going to show content which isn&#x2019;t a book? How am I going to power it? And&#x2026; The screen is too small. At least I bought it pretty cheap from an auction on ebay, let&#x2019;s see what I can do with it.</p><p>LED Rings&#x2026; They&#x2019;re a copy of Adafruit&#x2019;s wonderful <a href="https://www.adafruit.com/product/1586">NEOPixel Rings</a>. I would have bought the Adafruit&#x2019;s ones, would they be easily available in my country. But it&#x2019;s easier to search ebay for cheap electronic components than to visit every European Adafruit distributor and find in their online stores what I&#x2019;m looking for. Slight problem&#x2026; 36 Neopixel LEDs require 60mAx36=2.16A. No way I&#x2019;m pulling that from the RPi.</p><p>So here&#x2019;s the solution to my power-related problems: A power supply. Putting an internal power supply in the bannik device will cover all my power needs an minimize the cords running to it. A single cable from the outlet to the device is all I need. I worry 5A may not be enough to power all the devices, it&#x2019;ll probably be a close one.</p><p>And now&#x2026; a shell to hide all of this. I will use balsa wood or plywood to make a case. 3D printed supports will hold everything in place inside. The problem lies on the front of the device. Cutting out a circle in a wood sheet to show the LED rings won&#x2019;t be a problem, but cutting out a rectangle for the kindle may be, so I&#x2019;m considering 3D printing the whole front of the device.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/03_mounting_brackets-1.png" class="kg-image" alt="Bannik mounting brackets" loading="lazy" width="1853" height="789" srcset="https://inversebit.org/content/images/size/w600/2022/01/03_mounting_brackets-1.png 600w, https://inversebit.org/content/images/size/w1000/2022/01/03_mounting_brackets-1.png 1000w, https://inversebit.org/content/images/size/w1600/2022/01/03_mounting_brackets-1.png 1600w, https://inversebit.org/content/images/2022/01/03_mounting_brackets-1.png 1853w" sizes="(min-width: 720px) 720px"><figcaption>Bannik mounting brackets</figcaption></figure><p>Planning how to place everything inside, without the components interfering with each other is proving difficult, especially trying to minimize the footprint of the device.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/01_placing.png" class="kg-image" alt="Internal placing of the components that are part of bannik #1" loading="lazy" width="1613" height="681" srcset="https://inversebit.org/content/images/size/w600/2022/01/01_placing.png 600w, https://inversebit.org/content/images/size/w1000/2022/01/01_placing.png 1000w, https://inversebit.org/content/images/size/w1600/2022/01/01_placing.png 1600w, https://inversebit.org/content/images/2022/01/01_placing.png 1613w" sizes="(min-width: 720px) 720px"><figcaption>Internal placing of the components that are part of bannik #1</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/02_placing2.png" class="kg-image" alt="Internal placing of the components that are part of bannik #2" loading="lazy" width="1465" height="437" srcset="https://inversebit.org/content/images/size/w600/2022/01/02_placing2.png 600w, https://inversebit.org/content/images/size/w1000/2022/01/02_placing2.png 1000w, https://inversebit.org/content/images/2022/01/02_placing2.png 1465w" sizes="(min-width: 720px) 720px"><figcaption>Internal placing of the components that are part of bannik #2</figcaption></figure>]]></content:encoded></item><item><title><![CDATA[LCIECG]]></title><description><![CDATA[An intelligent low-cost electrocardiograph]]></description><link>https://inversebit.org/lciecg/</link><guid isPermaLink="false">61e31d46c6d1460f2de782e9</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Tue, 01 Jul 2014 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p><a href="https://github.com/Inversebit/LCIECG">Repo Link</a></p><p>A low-cost intelligent ECG. An android app that analyzes the health of the patient&#x2019;s heart using an <a href="https://www.olimex.com/Products/Duino/Shields/SHIELD-EKG-EMG/">Olimex ECG Shield</a> connected to an Arduino board. The data from the shield is relayed in real time via Bluetooth to an Android-running tablet, there the data is shown to the user. A series of complex algorithms are run to analyze the data, followed by an expert system which diagnoses the patient. All of this for about 70 euro.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://inversebit.org/content/images/2022/01/IMG_20140514_162842140-1.jpg" class="kg-image" alt="The electronic parts making up LCIECG" loading="lazy" width="2000" height="1123" srcset="https://inversebit.org/content/images/size/w600/2022/01/IMG_20140514_162842140-1.jpg 600w, https://inversebit.org/content/images/size/w1000/2022/01/IMG_20140514_162842140-1.jpg 1000w, https://inversebit.org/content/images/size/w1600/2022/01/IMG_20140514_162842140-1.jpg 1600w, https://inversebit.org/content/images/size/w2400/2022/01/IMG_20140514_162842140-1.jpg 2400w" sizes="(min-width: 720px) 720px"><figcaption>The electronic parts making up LCIECG</figcaption></figure><p>Here&apos;s a demo video of the device being assembled and used to perform an ECG:</p><figure class="kg-card kg-embed-card"><iframe width="200" height="150" src="https://www.youtube.com/embed/HKXyE4iy97Y?feature=oembed" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></figure>]]></content:encoded></item><item><title><![CDATA[SDMP]]></title><description><![CDATA[My own take on the famous Pong game]]></description><link>https://inversebit.org/sdmp/</link><guid isPermaLink="false">61e31282f1b187c30232703d</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Sun, 01 Jun 2014 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p><a href="https://github.com/Inversebit/SDMP">Repo Link</a></p><p>Super-duper mega Pong is a pretty plain clone of the game Pong. Some wonky &#x201C;physics&#x201D; are involved to make the game unpredictable. It&#x2019;s a beginners project using the <a href="http://libgdx.badlogicgames.com/">libGDX</a> library.</p>]]></content:encoded></item><item><title><![CDATA[Ardusonar]]></title><description><![CDATA[An Android sonar powered by Arduino]]></description><link>https://inversebit.org/ardusonar/</link><guid isPermaLink="false">61e31240f1b187c302327032</guid><dc:creator><![CDATA[Inversebit]]></dc:creator><pubDate>Tue, 01 Apr 2014 00:00:00 GMT</pubDate><content:encoded><![CDATA[<p><a href="https://github.com/Inversebit/ardusonar">Repo Link</a></p><p>A simple sonar made with Arduino. An ultrasound module attached to a servo sweeps an area and plots the distances to nearby objects in an Android-powered tablet. The data is transmitted via Bluetooth and it makes use of a custom <code>View</code> object to draw the data on the tablet&#x2019;s screen.</p>]]></content:encoded></item></channel></rss>